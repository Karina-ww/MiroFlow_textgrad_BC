defaults:
  - Agent_browsecomp-en_gpt
  - _self_
# Training settings
train:
  num_epochs: 3
  max_total_tasks: 120
  max_train_tasks_per_epoch: 50
  max_eval_tasks: 45
  train_ratio: 0.5
  batch_size: 8
  eval_every_n_epochs: 1
  seed: 42
  max_concurrent: 8
  selection_strategy: "max_feedback_length"
  run_initial_eval: false #WWW: 刚开始train
  max_retries_per_task: 2
  
  # ========================================
  # Memory Mechanism Settings (ENABLED)
  # ========================================
  use_memory: true  # Enable memory-enhanced feedback
  memory_strategy: "loss_bank"  # Options: "loss_bank", "episodic", "hybrid"
  memory_storage: "./memory_storage"
  memory_max_entries: 100  # Max feedback entries per agent
  memory_window: 50  # Rolling window size for loss_bank

# Output directory
output_dir: "./logs/textgrad_training_with_memory/checkForprompt_claude4"

# Benchmark settings
benchmark:
  name: "browsecomp-en"
  data:
    train_data_dir: "data/browsecomp-train"
    test_data_dir: "data/browsecomp-test-sub"
    metadata_file: "standardized_data.jsonl"
    whitelist: []
    train_size: 8
    val_size: 2
  execution:
    max_tasks: -1
    max_concurrent: 1
    pass_at_k: 1
  openai_api_key: "${oc.env:OPENAI_API_KEY,???}"
  openrouter_api_key: "${oc.env:OPENAI_API_KEY,???}"

# Main agent settings
main_agent:
  prompt_class: MainAgentPrompt_GAIA
  llm:
    provider_class: "ClaudeOpenRouterClient"
    model_name: "claude-4-sonnet"
    temperature: 0.3
    top_p: 0.95
    min_p: 0.0
    top_k: -1
    max_tokens: 32000
    openrouter_api_key: "${oc.env:OPENAI_API_KEY,???}"
    openrouter_base_url: "${oc.env:OPENAI_BASE_URL,https://yibuapi.com}"
    openrouter_provider: "anthropic"
    disable_cache_control: true
    keep_tool_result: -1
    oai_tool_thinking: false
  tool_config:
    - tool-reasoning
  max_turns: 50  # Maximum number of turns for main agent execution
  max_tool_calls_per_turn: 10  # Maximum number of tool calls per turn
  
  input_process:
    hint_generation: true
    hint_llm_base_url: "${oc.env:HINT_LLM_BASE_URL,https://yibuapi.com/v1}"
  output_process:
    final_answer_extraction: true
    final_answer_llm_base_url: "${oc.env:FINAL_ANSWER_LLM_BASE_URL,https://yibuapi.com/v1}"

  openai_api_key: "${oc.env:OPENAI_API_KEY,???}" # used for hint generation and final answer extraction
  add_message_id: true
  keep_tool_result: -1
  chinese_context: "${oc.env:CHINESE_CONTEXT,false}"

# Sub agent settings
sub_agents:
  agent-worker:
    prompt_class: SubAgentWorkerPrompt
    llm: 
      provider_class: "ClaudeOpenRouterClient"
      model_name: "claude-3-7-sonnet-20250219"
      async_client: true
      temperature: 0.3
      top_p: 0.95
      min_p: 0.0
      top_k: -1
      max_tokens: 32000
      openrouter_api_key: "${oc.env:OPENAI_API_KEY,???}"
      openrouter_base_url: "${oc.env:OPENAI_BASE_URL,https://yibuapi.com}"
      openrouter_provider: "anthropic"
      disable_cache_control: true
      keep_tool_result: -1
      oai_tool_thinking: false
    
    tool_config:
      - tool-searching
      - tool-image-video
      - tool-reading
      - tool-code
      - tool-audio

    max_turns: 50  # Maximum number of turns for main agent execution
    max_tool_calls_per_turn: 10  # Maximum number of tool calls per turn


# Evaluator engine for TextGrad
evaluator:
  provider_class: "ClaudeOpenRouterClient"
  model_name: "claude-4-sonnet"
  temperature: 0.7
  max_tokens: 8192
  timeout: 180
  async_client: true
  top_p: 0.95
  min_p: 0.0
  top_k: -1
  openrouter_api_key: "${oc.env:OPENAI_API_KEY,???}"
  openrouter_base_url: "${oc.env:OPENAI_BASE_URL,https://yibuapi.com}"
  openrouter_provider: "anthropic"
  disable_cache_control: true
  keep_tool_result: -1
  oai_tool_thinking: false
